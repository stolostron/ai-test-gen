| Step | Expected Result |
|------|-----------------|
| Create a ClusterCurator resource with custom labels: <br>`kubectl apply -f - <<EOF`<br>`apiVersion: cluster.open-cluster-management.io/v1beta1`<br>`kind: ClusterCurator`<br>`metadata:`<br>`  name: test-curator-labels`<br>`  namespace: default`<br>`  labels:`<br>`    app: my-curation`<br>`    owner: qe-team`<br>`spec:`<br>`  # Add appropriate curator spec here`<br>`EOF` | ClusterCurator resource is created successfully with the specified labels |
| Wait for the controller to create a Job from the ClusterCurator resource: <br>`kubectl wait --for=condition=Available clustercurator/test-curator-labels --timeout=300s` | Job is created by the controller within the timeout period |
| Verify the Job pod has the custom labels propagated from ClusterCurator: <br>`kubectl get pods -l app=my-curation,owner=qe-team -o jsonpath='{.items[*].metadata.labels}'` | Pod created by the Job contains labels: `{"app": "my-curation", "owner": "qe-team"}` |
| Create a ClusterCurator resource without any labels: <br>`kubectl apply -f - <<EOF`<br>`apiVersion: cluster.open-cluster-management.io/v1beta1`<br>`kind: ClusterCurator`<br>`metadata:`<br>`  name: test-curator-no-labels`<br>`  namespace: default`<br>`spec:`<br>`  # Add appropriate curator spec here`<br>`EOF` | ClusterCurator resource is created successfully without any labels |
| Wait for the controller to create a Job from the ClusterCurator resource: <br>`kubectl wait --for=condition=Available clustercurator/test-curator-no-labels --timeout=300s` | Job is created by the controller within the timeout period |
| Verify the Job pod template has empty or nil labels: <br>`kubectl get job -l clustercurator=test-curator-no-labels -o jsonpath='{.items[*].spec.template.metadata.labels}'` | Job pod template `metadata.labels` field is empty or nil |
| Create a ClusterCurator resource with initial label: <br>`kubectl apply -f - <<EOF`<br>`apiVersion: cluster.open-cluster-management.io/v1beta1`<br>`kind: ClusterCurator`<br>`metadata:`<br>`  name: test-curator-update`<br>`  namespace: default`<br>`  labels:`<br>`    version: v1`<br>`spec:`<br>`  # Add appropriate curator spec here`<br>`EOF` | ClusterCurator resource is created with version: v1 label |
| Trigger curation and wait for Job completion: <br>`kubectl wait --for=condition=Complete job -l clustercurator=test-curator-update --timeout=300s` | Initial curation Job completes successfully |
| Update the ClusterCurator resource with new label version: <br>`kubectl patch clustercurator test-curator-update --type='merge' -p='{"metadata":{"labels":{"version":"v2"}}}'` | ClusterCurator resource is updated with version: v2 label |
| Trigger a new curation by annotating the resource: <br>`kubectl annotate clustercurator test-curator-update curator.open-cluster-management.io/trigger-curation="$(date +%s)"` | New curation is triggered |
| Verify the newly created Job pod has the updated label: <br>`kubectl get pods -l version=v2 -o jsonpath='{.items[*].metadata.labels.version}'` | Newly created Job pod has label `{"version": "v2"}` |
| Verify the newly created Job pod does not have the old label: <br>`kubectl get pods -l version=v1` | No pods should be returned (old label should not exist on new pods) |